(()=>{"use strict";var l={};(l=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})})(l);const n={run(l){},start(l){},end(l){},move(l,n){}},o={conn:null,start(){this.conn=new WebSocket("ws://localhost/ws"),this.conn.onclose=function(l){console.warn("Connection closed")},this.conn.onopen=function(l){console.log("Socket connected")},this.conn.onmessage=function(l){let o=JSON.parse(l.data);n.run(o)}},joinRoom(l){this.send("join_room",{room_name:l})},createRoom(l){this.send("create_room",{room_name:l})},move(l,n){this.send("move",{from:l,to:n})},send(l,n){let o={action:l,...n},t=JSON.stringify(o);this.conn.send(t)}},t={create(l){console.log("create room: "+l),o.createRoom(l)},join(l){console.log("join room: "+l),o.joinRoom(l)}},e={canvas:null,ctx:null,cursor:{x:0,y:0},block:50,roomName:"",board:[[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]],start_positions:[[["rook",1],["knight",1],["bishop",1],["queen",1],["king",1],["bishop",1],["knight",1],["rook",1]],[["pawn",1],["pawn",1],["pawn",1],["pawn",1],["pawn",1],["pawn",1],["pawn",1],["pawn",1]],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[["pawn",0],["pawn",0],["pawn",0],["pawn",0],["pawn",0],["pawn",0],["pawn",0],["pawn",0]],[["rook",0],["knight",0],["bishop",0],["queen",0],["king",0],["bishop",0],["knight",0],["rook",0]]],color:null,canMove:!1,conn:null,init(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d")},start(){document.getElementById("join").style.display="none";for(let n=0;n<8;n++)for(let o=0;o<8;o++)null!==this.start_positions[n][o]&&(this.board[n][o]=new l.default(this.start_positions[n][o][0],o,n,this.start_positions[n][o][1]));this.tic()},draw(){this.draw_board()},tic(){this.draw()},draw_board:function(){this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillRect(0,0,8*this.block,8*this.block);let l=0;for(let n=0;n<8;n++){for(let o=0;o<8;o++)this.ctx.fillStyle=l%2==-0?"#ceb29c":"#f5e6cf",this.ctx.fillRect(o*this.block,n*this.block,this.block,this.block),l++;l++}},draw_chessmen:function(){for(let l=0;l<8;l++)for(let n=0;n<8;n++)null!==this.board[l][n]&&this.board[l][n].draw()}},u={start(){document.getElementById("createRoom").addEventListener("click",(l=>{t.create(document.getElementById("roomName").value)})),document.getElementById("joinRoom").addEventListener("click",(l=>{t.join(document.getElementById("roomName").value)})),e.canvas.addEventListener("mousedown",this.down),e.canvas.addEventListener("mouseup",this.up),e.canvas.addEventListener("mousemove",this.move)},down(l){let n=Math.floor(l.offsetX/e.block),o=Math.floor(l.offsetY/e.block);e.cursor.ox=n*e.block-l.offsetX,e.cursor.oy=o*e.block-l.offsetY,console.log([n,o])},up(l){let n=Math.floor(l.offsetX/e.block),o=Math.floor(l.offsetY/e.block);console.log([n,o])},move(l){e.cursor.x=l.offsetX,e.cursor.y=l.offsetY}};console.log("Start"),e.init(),u.start(),o.start(),e.start(),setTimeout((()=>{e.tic()}),1e3)})();